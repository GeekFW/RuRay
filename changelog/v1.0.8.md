# RuRay v1.0.8 更新日志

发布日期：2025-08-27

## 🚀 新功能

### 高级日志查看器
- **实时日志流功能**：新增独立的高级日志查看器窗口，支持实时显示 Xray Core 的日志输出
- **日志流配置**：在设置 > Core设置 > Xray Core设置中添加了"开启日志流"配置选项
- **无边框窗口**：高级日志窗口采用无标题栏设计，提供更简洁的用户界面
- **日志控制功能**：
  - 暂停/恢复日志显示
  - 清空日志缓冲区
  - 窗口关闭功能
- **日志格式化**：自动识别日志级别（Info、Warning、Error、Debug）并进行颜色标记
- **性能优化**：限制日志缓冲区大小，防止内存溢出

## 🔧 技术改进

### 后端优化
- **日志流管理**：实现了完整的日志流订阅和管理机制
- **新增 Tauri Commands**：
  - `subscribe_log_stream`：订阅日志流
  - `get_log_stream_buffer`：获取日志流缓冲区
  - `is_log_stream_available`：检查日志流可用性
  - `clear_log_stream_buffer`：清空日志流缓冲区
  - `open_advanced_log_window`：打开高级日志窗口
- **进程管理优化**：改进了 Xray Core 进程的启动和日志捕获机制
- **权限配置**：为 `advanced-log` 窗口添加了必要的关闭权限

### 前端优化
- **组件架构**：创建了独立的 `AdvancedLogViewer.vue` 组件
- **页面路由**：新增 `/advanced-log` 页面路由
- **事件处理优化**：修复了独立窗口中的事件监听权限问题
- **图标修复**：修复了 LogViewer 组件中不存在的 `heroicons:window-new` 图标

## 🐛 问题修复

### 核心修复
- **命令不存在错误**：修复了 `get_xray_logs` 命令不存在的问题
- **权限错误**：解决了 `app.vue` 中 `common.listenProxyStatusChangeFailed` 事件监听权限错误
- **窗口关闭问题**：修复了高级日志窗口无法关闭的权限问题
- **i18n 资源缺失**：添加了缺失的 `common.pause` 和 `common.resume` 翻译资源

### UI/UX 修复
- **图标显示**：将无效的 `heroicons:window-new` 替换为 `heroicons:rectangle-stack`
- **独立窗口适配**：优化了独立窗口与主窗口的功能分离
- **日志显示优化**：改进了日志的格式化和去重逻辑

## 🌐 国际化

### 新增翻译
- **中文**：`暂停`、`恢复`
- **英文**：`Pause`、`Resume`
- **日文**：`一時停止`、`再開`

## 📁 文件变更

### 新增文件
- `components/AdvancedLogViewer.vue` - 高级日志查看器组件
- `pages/advanced-log.vue` - 高级日志页面

### 修改文件
- `src-tauri/src/commands.rs` - 新增日志流相关命令
- `src-tauri/src/proxy.rs` - 优化日志流处理机制
- `src-tauri/capabilities/default.json` - 添加窗口权限配置
- `components/LogViewer.vue` - 添加高级日志按钮和图标修复
- `app.vue` - 修复独立窗口事件监听问题
- `i18n/locales/*.json` - 添加新的翻译资源

## 🔄 兼容性

- 保持与现有功能的完全兼容
- 新功能为可选启用，不影响现有用户体验
- 支持所有已支持的操作系统平台

## 📝 使用说明

1. 在设置中启用"开启日志流"选项
2. 在日志查看器中点击"高级日志查看器"按钮
3. 在新窗口中实时查看 Xray Core 日志
4. 使用暂停/恢复按钮控制日志显示
5. 使用清空按钮清理日志缓冲区

---

**完整更新内容**：本版本主要专注于日志查看功能的全面升级，提供了更强大、更直观的日志监控体验。